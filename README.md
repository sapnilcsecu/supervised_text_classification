<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><strong><u><span style="font-size:12.0pt"><span style="font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">load dataset</span></span></u></strong></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"><span style="font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"><span style="color:#595858">To prepare the dataset, load the downloaded data into a pandas dataframe</span></span></span><span style="font-size:12.0pt"><span style="font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> <span style="color:#595858">containing two columns &ndash; text and label.</span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">load_data = dataset_load();</span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">trainDF = load_data.load_cvs_dataset(</span></span></span><em><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:#00aa00">&quot;../corpus.csv&quot;</span></span></span></em><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">)</span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">txt_label = trainDF[</span></span></span><em><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:#00aa00">&#39;label&#39;</span></span></span></em><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">]</span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">txt_text = trainDF[</span></span></span><em><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:#00aa00">&#39;text&#39;</span></span></span></em><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">]</span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif">this code segment&nbsp; found in <a href="https://github.com/sapnilcsecu/supervised_text_classification/blob/master/super_text_class/example/trainmodel_write.py">trainmodel_write.py</a></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:blue">def</span></span></span><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black"> <strong>load_cvs_dataset</strong>(<em>self</em>,dataset_path):</span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:silver">#Set Random seed</span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">np.random.seed(</span></span></span><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:maroon">500</span></span></span><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">)</span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:silver"># Add the Data using pandas</span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">Corpus = pd.read_csv(dataset_path,encoding=</span></span></span><em><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:#00aa00">&#39;<u>latin</u>-1&#39;</span></span></span></em><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">,error_bad_lines=</span></span></span><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:blue">False</span></span></span><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">)</span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:blue">return</span></span></span><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black"> Corpus</span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">this code segment found in <a href="https://github.com/sapnilcsecu/supervised_text_classification/blob/master/super_text_class/dataset_pre/dataset_load.py"><strong><span style="background-color:#ffff96">dataset_load.py</span></strong></a></span></span></span></span></span></p>



<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><strong><u><span style="font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Text Feature Engineering:</span></u></strong></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="background-color:white"><span style="font-family:Calibri,sans-serif"><span style="font-size:11.5pt"><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;"><span style="color:#595858">The next step is the feature engineering step. In this step, raw text data will be transformed into feature vectors and new features will be created using the existing dataset. We will implement the following different ideas in order to obtain relevant features from our dataset.</span></span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="background-color:white"><span style="font-family:Calibri,sans-serif"><span style="font-size:11.5pt"><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;"><span style="color:#595858">Count Vectors as features<br />
TF-IDF Vectors as features</span></span></span></span></span></span></p>

<ul>
	<li><span style="font-size:11pt"><span style="background-color:white"><span style="color:#595858"><span style="font-family:Calibri,sans-serif"><span style="font-size:11.5pt"><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;">Word level</span></span></span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="background-color:white"><span style="color:#595858"><span style="font-family:Calibri,sans-serif"><span style="font-size:11.5pt"><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;">N-Gram level</span></span></span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="background-color:white"><span style="color:#595858"><span style="font-family:Calibri,sans-serif"><span style="font-size:11.5pt"><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;">Character level</span></span></span></span></span></span></li>
</ul>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="background-color:white"><span style="font-family:Calibri,sans-serif"><span style="font-size:11.5pt"><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;"><span style="color:#595858">Lets look at the implementation of these ideas in detail.</span></span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="background-color:white"><span style="font-family:Calibri,sans-serif"><strong><u><span style="font-size:12.0pt"><span style="font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"><span style="color:#333333">Count Vectors as features</span></span></span></u></strong></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:11.5pt"><span style="background-color:white"><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;"><span style="color:#595858">Count Vector is a matrix notation of the dataset in which every row represents a document from the corpus, every column represents a term from the corpus, and every cell represents the frequency count of a particular term in a particular document.</span></span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in">&nbsp;</p>


<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="background-color:#ffff96"><span style="font-family:Consolas"><span style="color:black">&nbsp; &nbsp; &nbsp; &nbsp; Train_X</span></span></span></span><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">, Test_X, Train_Y, Test_Y = model_selection.train_test_split(txt_text,txt_label)</span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; count_vect = CountVectorizer(analyzer=</span></span></span><em><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:#00aa00">&#39;word&#39;</span></span></span></em><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">)</span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; count_vect.fit(txt_text)</span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:silver"># transform the training and validation data using count <u>vectorizer</u> object</span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Train_X_count =&nbsp; count_vect.transform(<span style="background-color:#ffff96">Train_X</span>)</span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in"><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Consolas"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Test_X_count =&nbsp; count_vect.transform(Test_X)&nbsp;&nbsp; </span></span></span></span></span></p>
<h3 style="margin-left:0in; margin-right:0in"><span style="font-size:13.5pt"><span style="background-color:white"><span style="font-family:&quot;Times New Roman&quot;,serif"><strong><u><span style="font-size:12.0pt"><span style="color:#333333">TF-IDF Vectors as features</span></span></u></strong></span></span></span></h3>

<p style="margin-left:0in; margin-right:0in; text-align:justify"><span style="font-size:12pt"><span style="background-color:white"><span style="font-family:&quot;Times New Roman&quot;,serif"><span style="font-size:11.5pt"><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;"><span style="color:#595858">TF-IDF score represents the relative importance of a term in the document and the entire corpus. TF-IDF score is composed by two terms: the first computes the normalized Term Frequency (TF), the second term is the Inverse Document Frequency (IDF), computed as the logarithm of the number of the documents in the corpus divided by the number of documents where the specific term appears.</span></span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in; text-align:justify"><span style="font-size:12pt"><span style="background-color:white"><span style="font-family:&quot;Times New Roman&quot;,serif"><span style="font-size:11.5pt"><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;"><span style="color:#595858">TF(t) = (Number of times term t appears in a document) / (Total number of terms in the document)<br />
IDF(t) = log_e(Total number of documents / Number of documents with term t in it)</span></span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in; text-align:justify"><span style="font-size:12pt"><span style="background-color:white"><span style="font-family:&quot;Times New Roman&quot;,serif"><span style="font-size:11.5pt"><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;"><span style="color:#595858">TF-IDF Vectors can be generated at different levels of input tokens (words, characters, n-grams)</span></span></span></span></span></span></p>

<p style="margin-left:0in; margin-right:0in; text-align:justify"><span style="font-size:12pt"><span style="background-color:white"><span style="font-family:&quot;Times New Roman&quot;,serif"><strong><span style="font-size:11.5pt"><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;"><span style="color:#333333">a. Word Level TF-IDF :</span></span></span></strong><span style="font-size:11.5pt"><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;"><span style="color:#595858">&nbsp;Matrix representing tf-idf scores of every term in different documents</span></span></span><br />
<strong><span style="font-size:11.5pt"><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;"><span style="color:#333333">b. N-gram Level TF-IDF :</span></span></span></strong><span style="font-size:11.5pt"><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;"><span style="color:#595858">&nbsp;N-grams are the combination of N terms together. This Matrix representing tf-idf scores of N-grams</span></span></span><br />
<strong><span style="font-size:11.5pt"><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;"><span style="color:#333333">c. Character Level TF-IDF :</span></span></span></strong><span style="font-size:11.5pt"><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;"><span style="color:#595858">&nbsp;Matrix representing tf-idf scores of character level n-grams in the corpus</span></span></span></span></span></span></p>

